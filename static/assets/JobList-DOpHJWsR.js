import{t as e}from"./TableView-ED9yLtT8.js";import{B as t,Bt as n,I as ee,Ot as r,Qt as i,R as a,Rt as o,_t as s,b as c,c as l,f as u,gt as te,in as d,kt as f,l as p,pt as m,qt as h,ut as g,vt as _,y as ne,yt as v}from"./main-DLAKPujJ.js";/* empty css            *//* empty css            *//* empty css            *//* empty css            */import{t as y}from"./SpaceGap-CIjk4lfa.js";/* empty css            *//* empty css            *//* empty css            *//* empty css            *//* empty css            *//* empty css            */import{t as b}from"./GridRow-BmMdcQMJ.js";import"./IconRemixTemp-DeAFsH1z.js";import{t as x}from"./ViewIconBtn-DqZlxRSL.js";import{n as S,r as C,t as w}from"./CreateBtn-DFkXJKP5.js";import{t as T}from"./RefreshIconBtn-BXtIwmmV.js";import{n as E,t as D}from"./SearchBtn-Dy2YS8YI.js";import O from"./JobCategory-BVmTD-_L.js";import k from"./JobCategoryLabel-DPsF33kf.js";import"./JobCondition-CSVKuKsX.js";import A from"./JobConditionLabel-DOMW7kYs.js";import j from"./JobModel-CfdVGzI7.js";import M from"./JobModelLabel-5f1b3U81.js";import N from"./JobStatus-BqjBH-r5.js";import P from"./JobStatusTags-Bf4EIQXW.js";import F from"./JobEdit-B1lO_aEj.js";var I=[`onClick`],L=v({name:`JobList`}),R=Object.assign(L,{setup(d){let v=l(),L=h(),{table:R,page:z,useTableSearchFormSubmit:B,useTableRemove:V,useTableSearch:H,searchRef:U,useTableSearchReset:W,useTableSearchResetLoad:G,useTableDownload:K,searchForm:q}=useTable({api:`natsjob/api/app-job`,excelName:``,searchFields:{appId:v.params.appId,namespaceId:v.params.namespaceId,name:null,status:null,category:null,model:null}});r(()=>{H()});let J=()=>{L.value.createData({namespaceId:v.params.namespaceId,appId:v.params.appId})},Y=e=>{L.value.editData(e)},X=p(),Z=e=>{X.push({name:`JobResultList`,params:{cmd:`detail`,jobId:e.id},meta:{title:`任务结果列表`}})},re=async e=>{await $post(`natsjob/api/app-job/send`,{id:e.id})?$success(`发送成功`):$error(`发送失败)`)};return o(q,(e,t)=>{q.category==`map`&&q.model==`ultra`&&(q.model=``)}),(r,o)=>{let l=t,d=c,p=N,h=O,v=j,W=D,K=E,X=ne,ie=w,ae=T,oe=y,se=a,Q=u,ce=P,le=k,ue=M,de=A,fe=S,pe=C,$=x,me=ee,he=b,ge=e,_e=F;return f(),te(g,null,[_(ge,{data:i(R).data,page:i(z),search:i(H)},{search:n(()=>[_(X,{inline:!0,model:i(q),rules:r.rules,ref_key:`searchRef`,ref:U,"label-width":`80px`},{default:n(()=>[_(d,{label:`服务名`,prop:`name`},{default:n(()=>[_(l,{modelValue:i(q).name,"onUpdate:modelValue":o[0]||=e=>i(q).name=e,modelModifiers:{trim:!0},clearable:``,style:{width:`140px`}},null,8,[`modelValue`])]),_:1}),_(d,{label:`状态`,prop:`status`},{default:n(()=>[_(p,{modelValue:i(q).status,"onUpdate:modelValue":o[1]||=e=>i(q).status=e},null,8,[`modelValue`])]),_:1}),_(d,{label:`分类`,prop:`category`},{default:n(()=>[_(h,{modelValue:i(q).category,"onUpdate:modelValue":o[2]||=e=>i(q).category=e},null,8,[`modelValue`])]),_:1}),_(d,{label:`模式`,prop:`model`},{default:n(()=>[_(v,{modelValue:i(q).model,"onUpdate:modelValue":o[3]||=e=>i(q).model=e,category:i(q).category,"onUpdate:category":o[4]||=e=>i(q).category=e},null,8,[`modelValue`,`category`])]),_:1}),_(d,{style:{"margin-left":`10px`}},{default:n(()=>[_(W,{onclick:i(B)},null,8,[`onclick`]),_(K,{onclick:i(G)},null,8,[`onclick`])]),_:1})]),_:1},8,[`model`,`rules`])]),header:n(()=>[_(ie,{onclick:J}),_(ae,{onclick:i(H)},null,8,[`onclick`]),_(oe),_(se,{effect:`dark`,placement:`top`},{content:n(()=>[...o[5]||=[s(` 执行任务与标准下发策略完全相同, 不符合条件不会执行`,-1),m(`br`,null,null,-1),s(` 例如: 超过并发数,无注册服务,非主节点等 `,-1)]]),default:n(()=>[o[6]||=m(`i`,{class:`ri-question-line ri-xl`},null,-1)]),_:1})]),column:n(()=>[_(Q,{type:`index`,width:`50`}),_(Q,{prop:`id`,label:`编号`,"min-width":`180`}),_(Q,{prop:`name`,label:`任务名`,"min-width":`200`,"show-overflow-tooltip":``}),_(Q,{prop:`description`,label:`说明`,"min-width":`200`,"show-overflow-tooltip":``}),_(Q,{prop:`status`,label:`状态`,"min-width":`120`},{default:n(({row:e})=>[_(ce,{modelValue:e.status,"onUpdate:modelValue":t=>e.status=t},null,8,[`modelValue`,`onUpdate:modelValue`])]),_:1}),_(Q,{prop:`cron`,label:`定时`,"min-width":`160`}),_(Q,{prop:`category`,label:`分类`,"min-width":`140`},{default:n(({row:e})=>[_(le,{modelValue:e.category,"onUpdate:modelValue":t=>e.category=t},null,8,[`modelValue`,`onUpdate:modelValue`])]),_:1}),_(Q,{prop:`model`,label:`模式`,"min-width":`140`},{default:n(({row:e})=>[_(ue,{modelValue:e.model,"onUpdate:modelValue":t=>e.model=t},null,8,[`modelValue`,`onUpdate:modelValue`])]),_:1}),_(Q,{prop:`maxWorkers`,label:`最大并发`,"min-width":`120`}),_(Q,{prop:`timeoutSeconds`,label:`超时时间(秒)`,"min-width":`120`}),_(Q,{prop:`condition`,label:`条件`,"min-width":`140`},{default:n(({row:e})=>[_(de,{modelValue:e.condition,"onUpdate:modelValue":t=>e.condition=t},null,8,[`modelValue`,`onUpdate:modelValue`])]),_:1}),_(Q,{prop:`args`,label:`参数`,"min-width":`120`,"show-overflow-tooltip":``}),o[8]||=s("`` ",-1),_(Q,{prop:`appId`,label:`服务编号`,"min-width":`180`}),_(Q,{prop:`namespaceId`,label:`命名空间编号`,"min-width":`180`}),_(Q,{prop:`createdAt`,label:`创建日期`,"min-width":`180`}),_(Q,{prop:`updatedAt`,label:`更新日期`,"min-width":`180`}),_(Q,{fixed:`right`,label:`操作`,width:`200`},{default:n(({row:e})=>[_(he,{span:4},{default:n(()=>[m(`div`,{onClick:t=>Y(e)},[_(fe)],8,I),m(`div`,null,[_(pe,{onConfirm:t=>i(V)(e.id)},null,8,[`onConfirm`])]),m(`div`,null,[_($,{onClick:t=>Z(e)},null,8,[`onClick`])]),m(`div`,null,[_(me,{text:``,bg:``,type:`success`,onClick:t=>re(e)},{default:n(()=>[...o[7]||=[s(` 执行 `,-1)]]),_:1},8,[`onClick`])])]),_:2},1024)]),_:1})]),_:1},8,[`data`,`page`,`search`]),_(_e,{ref_key:`editRef`,ref:L,onLoad:i(H)},null,8,[`onLoad`])],64)}}});export{R as default};